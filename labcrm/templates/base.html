<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
	{% load static %}
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel='stylesheet' type='text/css' href="{% static 'bootstrap3\css\bootstrap.min.css' %}" />
	<link rel='stylesheet' type='text/css' href="{% static 'bootstrap3\css\bootstrap-theme.min.css' %}" />
	{% block link %}<link />{% endblock %}
    <title>{% block title %}标题{% endblock %}</title>
</head>
<body class='container-fluid'>
<header class='row'>
{% block h1 %}
<h1 class='col-md-12 text-center'><a href='{% url "homepage" %}'>crossin编程实战训练营</a></h1>
{% endblock %}
<nav class="col-md-12 navbar navbar-default {% block topFix %}{% endblock %}">
	<div class='container-fluid'>
		{% block homeLink %}{% endblock %}
		<ul class="nav navbar-nav">
			<li class='{% block userList %}{% endblock %}'><a href='{% url "crm:list" %}'>用户列表</a></li>
			<li class='visible-lg-inline visible-sm-inline visible-md-inline'><a>|</a></li>
			<li class='{% block quesConf %}{% endblock %}'><a href='{% url "crm:conf" %}'>问卷设计</a></li>
			<li class='visible-lg-inline visible-sm-inline visible-md-inline'><a>|</a></li>
			<li class='{% block webotConf %}{% endblock %}'><a href='{% url "webot:rule" %}'>微信配置</a></li>
		</ul>
		<form class="navbar-form navbar-right" action='{% url "accounts:login" %}' id='fromNavbar' method='POST'>
		{% csrf_token %}
		{% if user.is_authenticated %}
			<label>欢迎您：{{ user }}</label>
			<a class="btn btn-default" href='{% url "accounts:logout" %}'>登出</a>
		</form>
		{% else %}
			<div class="form-group">
				<input name='username' type="text" class="form-control" placeholder="用户名">
				<input name='password' type="password" class="form-control" placeholder="密码">
			</div>
			<button type="submit" class="btn btn-default" onclick='navbarLogin()'>登录</button>
		</form>
		{% endif %}
	</div>
</nav>
</header>
<hr />
<content class='row'>
{% block content %}内容{% endblock %}
</content>
<footer class='row'>
	{% block footer %}{% endblock %}
	<p class='text-center'><b><a>***感谢访问***</a></b></p>
</footer>
{% block modal %}{% endblock %}
<!--script src="http://code.jquery.com/jquery.js"></script-->
<script src="{% static 'bootstrap3\js\jquery.min.js' %}"></script>
<script src="{% static 'bootstrap3\js\bootstrap.min.js' %}"></script>
<script src="{% static 'bootstrap3\js\npm.js' %}"></script>
<script>
function navbarLogin(){
	var para = document.getElementById('fromNavbar');
	para.onsubmit = function(e){
		e.preventDefault();
		var f = e.target,
			formData = new FormData(f),
			xhr = new XMLHttpRequest();
		xhr.open("POST", f.action, true);
		xhr.onreadystatechange=function(){
			if(xhr.readyState == 4 && xhr.status == 200){
				var rowNew = xhr.responseText;
				if(rowNew.length>0){
					para.innerHTML = rowNew;
				}else{
					alert('用户名或密码错误！');
				};
			};
		};
		xhr.send(formData);
	};
};

function h(e) {
	// textarea 高度自增长
	if(e.scrollHeight<80){
		$(e).css({'height':'auto','overflow-y':'hidden'}).height(84);
	}else{
		$(e).css({'height':'auto','overflow-y':'hidden'}).height(e.scrollHeight);
	};
};
$('textarea').each(function () {
	h(this);
}).on('input', function () {
	h(this);
});
</script>
{% block script %}{% endblock %}
</body>
</html>