<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
	{% load static %}
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel='stylesheet' type='text/css' href="{% static 'bootstrap3\css\bootstrap.min.css' %}" />
	<link rel='stylesheet' type='text/css' href="{% static 'bootstrap3\css\bootstrap-theme.min.css' %}" />
	{% block link %}<link />{% endblock %}
    <title>{% block title %}标题{% endblock %}</title>
</head>
<body>
<header>
{% block h1 %}
<h1 class='text-center'><a href='{% url "homepage" %}'>crossin编程教室实验室</a></h1>
{% endblock %}
<nav class="navbar navbar-default {% block topFix %}{% endblock %}">
	<div class='container-fluid'>
		{% block homeLink %}{% endblock %}
		<ul class="nav navbar-nav">
			<li class='{% block userList %}{% endblock %}'><a href='{% url "crm:list" %}'>用户列表</a></li>
			<li><a>|</a></li>
			<li class='{% block quesConf %}{% endblock %}'><a href='{% url "crm:conf" %}'>问卷设计</a></li>
			<li><a>|</a></li>
			<li class='{% block webotConf %}{% endblock %}'><a href='{% url "webot:rule" %}'>微信配置</a></li>
		</ul>
		<form class="navbar-form navbar-right" action='{% url "accounts:login" %}' id='formLogin'>
		{% if user.is_authenticated %}
			<label>欢迎您：{{ user }}</label>
			<button class="btn btn-default">登出</button>
		</form>
		{% else %}
			<div class="form-group">
				<input name='username' type="text" class="form-control" placeholder="用户名">
				<input name='password' type="text" class="form-control" placeholder="密码">
			</div>
			<button type="submit" class="btn btn-default" onclick='login()'>登录</button>
		</form>
		{% endif %}
	</div>
</nav>
</header>
<hr />
{% block content %}内容{% endblock %}
<footer>
	{% block footer %}{% endblock %}
	<p class='text-center'><b><a>***感谢访问***</a></b></p>
</footer>
{% block modal %}{% endblock %}
{% block script %}{% endblock %}
<script src="http://code.jquery.com/jquery.js"></script>
<script src="{% static 'bootstrap3\js\bootstrap.min.js' %}"></script>
<script src="{% static 'bootstrap3\js\npm.js' %}"></script>
<script>
function login(){
	var para = document.getElementById('formLogin');
	para.onsubmit(e){
		e.preventDefault();
		var f = e.target,
			formData = new FormData(f),
			xhr = new XMLHttpRequest();
		xhr.open("POST", f.action, true);
		xhr.onreadystatechange=function(){
			if(xhr.readyState == 4 && xhr.status == 200){
				var rowNew = xhr.responseText;
				if(rowNew.length>0){
					para.innerHTML = rowNew;
				}else{
					alter('用户名或密码错误！');
				};
			};
		};
		xhr.send(formData);
	};
};
</script>
</body>
</html>